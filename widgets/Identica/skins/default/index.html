<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>Test Widget</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="melange.css" media="screen">
    <script type="text/javascript" src="scripts/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="scripts/easyscroll.js"></script>
</head>

<body>
    <div class="widget" style="width: 160px; height: 228px;">
        <div id="up" style="height: 12px; padding: 1px; text-align: center; background-color: rgba(256, 256, 256, .1); border-top-right-radius: 3px; border-top-left-radius: 3px;">
            <img src="images/up.png" />
        </div>
        <div id="myContent" style="background-color: rgba(256, 256, 256, .03);">
            <div id="identica"></div>

            <script type="text/javascript">
            function foo (data) {
                for (var c = 0; c < data.length && c < 10; c++) {
                    var content = data[c]['text'];
                    content = content.replace(/http:\/\/([^ ]+)/g, "<a class=\"thin\" href=\"http://$1\" target=\"_laconica\">http://$1</a>");
                    content = content.replace(/@([\w*]+)/g, '@<a class=\"thin\" href="http://identi.ca/$1" target=\"_laconica\">$1</a>');
                    content = content.replace(/#([\w*]+)/g, '#<a class=\"thin\" href="http://identi.ca/tag/$1" target="_laconica">$1</a>');
                    content = content.replace(/!([\w*]+)/g, '!<a class=\"thin\" href="http://identi.ca/group/$1" target="_laconica">$1</a>');
            
                    box = document.createElement('div')
                    box.innerHTML = '<span style="font-size: .9em; font-style: italic;">' + content + '</span><br /><span style="font-size: .7em; color: #999;">- ' + data[c]['user']['screen_name'] + ' at ' + data[c]['created_at'].split(/\+/)[0] + '</span>';
            
                    if (c != 0) {
                        box.style.paddingTop = "10px";
                    }
            
                    document.getElementById('identica').appendChild(box)
                }  
            }
            
            var head = document.getElementsByTagName("head")[0];
            script = document.createElement('script');
            script.id = 'data';
            script.type = 'text/javascript';
            script.src = "https://identi.ca/api/statusnet/groups/timeline/cream.json?callback=foo";
            head.appendChild(script);
            </script>
        </div>
        <div id="down" style="height: 12px; padding: 1px; text-align: center; background-color: rgba(256, 256, 256, .1); border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;">
            <img src="images/down.png" />
        </div>
    </div>
</body>
</html>


